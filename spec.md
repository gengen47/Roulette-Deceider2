飲食店決定Webアプリ「Roulette Decider」開発指示書

1. プロジェクト概要
目的: 「何食べる？」で揉めるグループやカップルの意思決定を、ゲーミフィケーション（ルーレット）で強制解決するWebサービス。 ターゲット: スマホユーザー（モバイルファーストデザイン）。 コア体験: 現在地周辺の店と、ユーザー独自の選択肢（自炊など）を混ぜてルーレットを回し、運命の食事を決定する。

2. システム構成図（AIへの理解用）
sequenceDiagram
    actor User as ユーザー
    participant App as Webアプリ (Frontend)
    participant API as ホットペッパーAPI
    participant Logic as ルーレットロジック

    Note over User, App: 1. 初期化フェーズ
    User->>App: アプリを開く & 位置情報許可
    App->>API: 店舗検索リクエスト (緯度・経度, 半径3000m)
    API-->>App: 店舗データ返却 (JSON)
    App->>App: ランダムに3店舗選出 & 初期表示

    Note over User, App: 2. 設定フェーズ
    User->>App: カスタム選択肢ON (例: コンビニ, 自炊)
    User->>App: 確率スライダー調整 (重み付け変更)
    App->>Logic: 各項目の当選確率を再計算 (円グラフ描画更新)

    Note over User, App: 3. 抽選フェーズ
    User->>App: 「START」ボタン押下
    App->>Logic: ルーレット回転アニメーション開始
    Logic->>Logic: 重み付けに基づき当選項目を決定
    Logic-->>App: 抽選結果確定

    Note over User, App: 4. 結果表示フェーズ
    alt 飲食店が当選
        App-->>User: 店舗情報 & 「今すぐ予約」ボタン表示
        Note right of App: ボタンURLはLinkSwitch対応
    else カスタム項目が当選
        App-->>User: 項目名 & ユーモアメッセージ表示
    end

3. 具体的な機能要件
A. データ取得フェーズ

Geolocation API: ブラウザ標準機能で現在地（緯度・経度）を取得。

ホットペッパーグルメAPI連携:

エンドポイント: /gourmet/v1/

パラメータ: lat (緯度), lng (経度), range (5: 3000m以内 ※広めに設定), count (100: ランダム抽出の母数を増やすため)

フィルタリング: 取得した中からランダムで3店舗だけをピックアップ。

取得項目: 店名、キャッチコピー、店舗画像(PCサイズ)、店舗URL(PC向け)、ジャンル。

B. カスタム選択肢と確率設定（重要機能）

「混ぜる」オプション:

APIで取得した3店舗に加え、以下のカスタム項目をチェックボックスで追加可能にする。

デフォルト項目: 「コンビニ」「自炊」「断食（食べない）」

自由入力欄: ユーザーが好きな選択肢（例: 「マクドナルド」）を追加可能にする。

確率の重み付け（Weighted Probability）:

各選択肢（店舗A, 店舗B, 店舗C, コンビニ, 自炊...）の横に「スライダー（1〜10）」を設置。

スライダーを動かすと、リアルタイムでルーレットの円グラフの面積（当選確率）が変化するUIを実装。

計算ロジック: (その項目の重み / 全項目の重みの合計) * 100 で確率を算出。

C. ルーレット演出

ビジュアル: Canvas API または CSS を使用し、円グラフ型のルーレットを描画。

アニメーション: 「START」ボタンで回転開始し、徐々に減速して止まる演出。ワクワク感を演出するため、回転時間は3秒以上確保。

D. 結果画面と収益化

当選結果: 選ばれた店（または項目）を大きく表示。

アクションボタン:

飲食店の場合: 「今すぐ予約する（ホットペッパー）」ボタン。

リンク先: APIから取得した店舗URL。

収益化対応: HTMLヘッダーにバリューコマースの LinkSwitch タグを埋め込むためのプレースホルダー（コメントアウト状態）を用意すること。

その他（自炊など）の場合: 「レシピを検索（Google）」などのユーモアあるボタンを表示。

リトライ: 「もう一回回す」ボタン（将来的に広告を挟める設計にしておく）。

4. UI/UXデザインガイドライン
デザインテーマ: 「Uber Eats」のような清潔感 × 「カジノ」のエンタメ感。

配色:

メインカラー: #FFAB40 (食欲をそそるオレンジ)

アクセント: #212121 (引き締め用の黒)

背景: 白ベースで見やすく。

レイアウト: スマホ縦持ち（Portrait）に最適化。親指で操作しやすい位置にボタンを配置。

5. 技術スタック指定
Frontend: HTML5, Tailwind CSS (CDN版), Vanilla JavaScript (フレームワークなし)。

ファイル構成: 初心者でも修正しやすいよう、index.html 1ファイル にすべて（HTML, CSS, JS）を記述してください。

API通信: fetch メソッドを使用。

注意点: ホットペッパーAPIはCORSエラーが出る可能性があるため、開発用として「モックデータモード（APIキーなしでも動くダミーデータ）」と「本番モード」を切り替えられる変数 (const IS_DEBUG = true;) を用意してください。